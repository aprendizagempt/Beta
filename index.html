<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cronograma Janeiro 2026 â€“ CCD 49/2025</title>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const btn = document.createElement("button");
  btn.id = "downloadIcs";
  btn.textContent = "ðŸ“… Adicionar aulas ao CalendÃ¡rio";
  btn.style.marginLeft = "8px";
  btn.style.background = "#3498db";
  btn.style.color = "#fff";
  btn.style.border = "none";
  btn.style.padding = "10px 20px";
  btn.style.borderRadius = "6px";
  btn.style.fontWeight = "bold";
  btn.style.cursor = "pointer";

  document.querySelector(".pdf-button-container").appendChild(btn);

  btn.onclick = () => {

    const aulas = [
      { day:6,  hour:9,  ufcd:"CD_B2_C" },
      { day:7,  hour:13, ufcd:"CD_B2_C" },
      { day:8,  hour:10, ufcd:"CD_B2_C" },
      { day:9,  hour:13, ufcd:"CD_B2_C" },
      { day:12, hour:9,  ufcd:"CD_B2_C" },
      { day:13, hour:9,  ufcd:"CD_B2_C" },
      { day:14, hour:13, ufcd:"CD_B2_D" },
      { day:15, hour:10, ufcd:"CD_B2_D" },
      { day:16, hour:13, ufcd:"CD_B2_D" },
      { day:20, hour:9,  ufcd:"CD_B2_D" },
      { day:21, hour:13, ufcd:"CD_B2_D" },
      { day:22, hour:10, ufcd:"CD_B2_D" },
      { day:23, hour:10, ufcd:"CD_B2_D" }
    ];

    let ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//IEFP CCD 49/2025//Cronograma Janeiro 2026//PT
CALSCALE:GREGORIAN
`;

    aulas.forEach(a => {
      const start = `202601${String(a.day).padStart(2,"0")}T${String(a.hour).padStart(2,"0")}0000`;
      const end   = `202601${String(a.day).padStart(2,"0")}T${String(a.hour+1).padStart(2,"0")}0000`;

      ics +=
`BEGIN:VEVENT
DTSTART:${start}
DTEND:${end}
SUMMARY:Aula de CompetÃªncias Digitais â€“ ${a.ufcd}
DESCRIPTION:CCD 49/2025 â€“ ProficiÃªncia Digital â€“ NÃ­vel BÃ¡sico
LOCATION:4NOW â€“ Viseu
BEGIN:VALARM
TRIGGER:-PT2H
ACTION:DISPLAY
DESCRIPTION:Lembrete: Aula de CompetÃªncias Digitais Ã s ${a.hour}:00
END:VALARM
END:VEVENT
`;
    });

    ics += `END:VCALENDAR`;

    const blob = new Blob([ics], { type: "text/calendar" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "Cronograma_Janeiro_2026_CCD49.ics";
    a.click();
    URL.revokeObjectURL(url);
  };
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{font-family:Helvetica,Arial,sans-serif;background:#f5f5f5;margin:0}
header{background:#2c3e50;color:#fff;text-align:center;padding:14px}
header h1{font-size:20px;margin:6px 0}
header h2{font-size:16px;margin:4px 0;font-weight:normal}
.digital-clock{background:#b39d74;text-align:center;padding:10px;margin:15px auto;width:95%;border-radius:6px;font-weight:bold}
.typewriter{white-space:nowrap;overflow:hidden;animation:typing 16s steps(160,end) infinite}
@keyframes typing{from{width:0}to{width:100%}}
.pdf-button-container{text-align:center;margin:12px}
#downloadPdf{background:#e74c3c;color:#fff;border:none;padding:10px 20px;border-radius:6px;font-weight:bold;cursor:pointer}
.calendar{border-collapse:collapse;min-width:700px;background:#fff;margin:auto}
.calendar th,.calendar td{border:1px solid #ccc;padding:6px;text-align:center;font-size:12px}
.header{background:#b39d74;color:#fff}
.time-col{background:#eee;font-weight:bold}
.green{background:#ccffcc}
.orange{background:#ffcc99}
.white{background:#fff}
.blinking{animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
footer{background:#2c3e50;color:#fff;text-align:center;padding:12px;font-size:12px}
footer a{color:#7ecbff;text-decoration:none}
footer a:hover{color:#fff;text-decoration:underline}
</style>
</head>

<body>

<header>
<h1>Cronograma Janeiro 2026</h1>
<h2>CCD 49/2025 â€“ ProficiÃªncia Digital â€“ NÃ­vel BÃ¡sico</h2>
</header>

<div class="pdf-button-container">
<button id="downloadPdf">ðŸ“„ Descarregar PDF</button>
</div>

<div class="digital-clock">
<div id="clockDisplay" class="typewriter">A carregar horÃ¡rio...</div>
</div>

<table class="calendar" id="scheduleTable">
<thead>
<tr>
<th class="header">Hora</th>
<th class="header">06</th><th class="header">07</th><th class="header">08</th><th class="header">09</th>
<th class="header">12</th><th class="header">13</th><th class="header">14</th><th class="header">15</th>
<th class="header">16</th><th class="header">20</th><th class="header">21</th><th class="header">22</th><th class="header">23</th>
</tr>
</thead>
<tbody>

<tr><td class="time-col">12â€“13</td>
<td class="white">AlmoÃ§o</td><td class="white">AlmoÃ§o</td>
<td class="green cell" id="d8-12"><span>CD_B2_C</span></td>
<td class="white">AlmoÃ§o</td>
<td class="white">AlmoÃ§o</td><td class="white">AlmoÃ§o</td>
<td class="white">AlmoÃ§o</td>
<td class="orange cell" id="d15-12"><span>CD_B2_D</span></td>
<td class="white">AlmoÃ§o</td>
<td class="white">AlmoÃ§o</td>
<td class="white">AlmoÃ§o</td>
<td class="orange cell" id="d22-12"><span>CD_B2_D</span></td>
<td class="orange cell" id="d23-12"><span>CD_B2_D</span></td>
</tr>

</tbody>
</table>

<footer>
Â© 2026 â€“ CCD 49/2025 | 
<a href="mailto:aprendizagem.pt@gmail.com">aprendizagem.pt@gmail.com</a>
</footer>

<script>
function getLisbonTime(){
 return new Date(new Date().toLocaleString('en-US',{timeZone:'Europe/Lisbon'}));
}
function parseId(id){
 const m=id.match(/d(\d+)-(\d+)/);
 return m?{day:+m[1],hour:+m[2]}:null;
}
function tick(){
 const now=getLisbonTime();
 let aula=false;
 document.querySelectorAll('.cell').forEach(c=>{
  c.classList.remove('blinking');
  const i=parseId(c.id); if(!i)return;
  const start=new Date(2026,0,i.day,i.hour);
  const end=new Date(2026,0,i.day,i.hour+1);
  if(now>=start&&now<end){
   aula=true;
   c.classList.add('blinking');
   clockDisplay.textContent=`${String(i.day).padStart(2,'0')}/01/2026 - ${String(i.hour).padStart(2,'0')}:00 | Aula: ${c.innerText} - A decorrer`;
  }
 });
 if(!aula){
  clockDisplay.textContent=`${now.toLocaleDateString('pt-PT')} - ${now.toLocaleTimeString('pt-PT',{hour:'2-digit',minute:'2-digit'})}`;
 }
}
setInterval(tick,1000);
tick();

downloadPdf.onclick=()=>{
 const {jsPDF}=window.jspdf;
 html2canvas(scheduleTable).then(c=>{
  const pdf=new jsPDF('landscape','mm','a4');
  pdf.addImage(c.toDataURL('image/png'),'PNG',10,10,270,0);
  pdf.save('Horario_CCD49_Janeiro_2026.pdf');
 });
};
</script>

</body>
</html>