<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HorÃ¡rio CCD 49/2025</title>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const btn = document.createElement("button");
  btn.id = "downloadIcs";
  btn.textContent = "ðŸ“… Adicionar aulas ao CalendÃ¡rio";
  btn.style.marginLeft = "8px";
  btn.style.background = "#3498db";
  btn.style.color = "#fff";
  btn.style.border = "none";
  btn.style.padding = "10px 20px";
  btn.style.borderRadius = "6px";
  btn.style.fontWeight = "bold";
  btn.style.cursor = "pointer";

  document.querySelector(".pdf-button-container").appendChild(btn);

  btn.onclick = () => {

    const aulas = [
      { day:6,  hour:9,  ufcd:"CD_B2_C" },
      { day:7,  hour:13, ufcd:"CD_B2_C" },
      { day:8,  hour:10, ufcd:"CD_B2_C" },
      { day:9,  hour:13, ufcd:"CD_B2_C" },
      { day:12, hour:9,  ufcd:"CD_B2_C" },
      { day:13, hour:9,  ufcd:"CD_B2_C" },
      { day:14, hour:13, ufcd:"CD_B2_D" },
      { day:15, hour:10, ufcd:"CD_B2_D" },
      { day:16, hour:13, ufcd:"CD_B2_D" },
      { day:20, hour:9,  ufcd:"CD_B2_D" },
      { day:21, hour:13, ufcd:"CD_B2_D" },
      { day:22, hour:10, ufcd:"CD_B2_D" },
      { day:23, hour:10, ufcd:"CD_B2_D" }
    ];

    let ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//IEFP CCD 49/2025//Cronograma Janeiro 2026//PT
CALSCALE:GREGORIAN
`;

    aulas.forEach(a => {
      const start = `202601${String(a.day).padStart(2,"0")}T${String(a.hour).padStart(2,"0")}0000`;
      const end   = `202601${String(a.hour+1).padStart(2,"0")}0000`;

      ics +=
`BEGIN:VEVENT
DTSTART:${start}
DTEND:202601${String(a.day).padStart(2,"0")}T${String(a.hour+1).padStart(2,"0")}0000
SUMMARY:Aula de CompetÃªncias Digitais â€“ ${a.ufcd}
DESCRIPTION:CCD 49/2025 â€“ ProficiÃªncia Digital â€“ NÃ­vel BÃ¡sico
LOCATION:4NOW â€“ Viseu
BEGIN:VALARM
TRIGGER:-PT2H
ACTION:DISPLAY
DESCRIPTION:Lembrete: Aula de CompetÃªncias Digitais Ã s ${a.hour}:00
END:VALARM
END:VEVENT
`;
    });

    ics += `END:VCALENDAR`;

    const blob = new Blob([ics], { type: "text/calendar" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "Cronograma_Janeiro_2026_CCD49.ics";
    a.click();
    URL.revokeObjectURL(url);
  };
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<!-- âš ï¸ CSS, BODY, TABELA, CONTADORES, PDF, BLINKING, RELÃ“GIO
mantÃªm-se exatamente iguais ao que enviaste,
apenas a grelha horÃ¡ria foi ajustada conforme o resumo validado -->