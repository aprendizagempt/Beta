<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cronograma Janeiro 2026 â€“ CCD 49/2025</title>

<!-- ================= ICS ================= -->
<script>
document.addEventListener("DOMContentLoaded", () => {

  const btn = document.createElement("button");
  btn.id = "downloadIcs";
  btn.textContent = "ðŸ“… Adicionar aulas ao CalendÃ¡rio";
  btn.style.marginLeft = "8px";
  btn.style.background = "#3498db";
  btn.style.color = "#fff";
  btn.style.border = "none";
  btn.style.padding = "10px 20px";
  btn.style.borderRadius = "6px";
  btn.style.fontWeight = "bold";
  btn.style.cursor = "pointer";

  document.querySelector(".pdf-button-container").appendChild(btn);

  btn.onclick = () => {

    const aulas = [
      {day:6, hour:9},{day:7, hour:13},{day:8, hour:10},{day:9, hour:13},
      {day:12, hour:9},{day:13, hour:9},{day:14, hour:13},{day:15, hour:10},
      {day:16, hour:13},{day:20, hour:9},{day:21, hour:13},
      {day:22, hour:10},{day:23, hour:10}
    ];

    let ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//IEFP CCD 49/2025//Janeiro 2026//PT
CALSCALE:GREGORIAN
`;

    aulas.forEach(a=>{
      const start=`202601${String(a.day).padStart(2,"0")}T${String(a.hour).padStart(2,"0")}0000`;
      const end=`202601${String(a.day).padStart(2,"0")}T${String(a.hour+1).padStart(2,"0")}0000`;
      ics+=
`BEGIN:VEVENT
DTSTART:${start}
DTEND:${end}
SUMMARY:Aula de CompetÃªncias Digitais
LOCATION:4NOW â€“ Viseu
BEGIN:VALARM
TRIGGER:-PT2H
ACTION:DISPLAY
DESCRIPTION:Lembrete: Aula Ã s ${a.hour}:00
END:VALARM
END:VEVENT
`;
    });

    ics+=`END:VCALENDAR`;

    const blob=new Blob([ics],{type:"text/calendar"});
    const url=URL.createObjectURL(blob);
    const a=document.createElement("a");
    a.href=url;
    a.download="Cronograma_Janeiro_2026_CCD49.ics";
    a.click();
    URL.revokeObjectURL(url);
  };
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<!-- ================= CSS ================= -->
<style>
body{font-family:Helvetica,Arial,sans-serif;background:#f5f5f5;margin:0}
header{background:#2c3e50;color:#fff;text-align:center;padding:14px}
header h1{margin:6px 0}
.digital-clock{background:#b39d74;text-align:center;padding:10px;margin:15px auto;width:95%;border-radius:6px;font-weight:bold}
.typewriter{white-space:nowrap;overflow:hidden;animation:typing 18s steps(180,end) infinite}
@keyframes typing{from{width:0}to{width:100%}}
.pdf-button-container{text-align:center;margin:12px}
#downloadPdf{background:#e74c3c;color:#fff;border:none;padding:10px 20px;border-radius:6px;font-weight:bold;cursor:pointer}
.calendar{border-collapse:collapse;min-width:700px;background:#fff;margin:auto}
.calendar th,.calendar td{border:1px solid #ccc;padding:6px;text-align:center;font-size:12px}
.header{background:#b39d74;color:#fff}
.time-col{background:#eee;font-weight:bold}
.green{background:#ccffcc}
.white{background:#fff}
.blinking{animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
footer{background:#2c3e50;color:#fff;text-align:center;padding:12px;font-size:12px}
footer a{color:#7ecbff;text-decoration:none}
footer a:hover{color:#fff}
</style>
</head>

<body>

<header>
<h1>Cronograma Janeiro 2026</h1>
<div>CCD 49/2025 â€“ ProficiÃªncia Digital â€“ NÃ­vel BÃ¡sico</div>
<div>4NOW â€“ Viseu</div>
</header>

<div class="pdf-button-container">
<button id="downloadPdf">ðŸ“„ Descarregar PDF</button>
</div>

<div class="digital-clock">
<div id="clockDisplay" class="typewriter">A carregar horÃ¡rioâ€¦</div>
</div>

<table class="calendar" id="scheduleTable">
<thead>
<tr>
<th class="header">Hora</th>
<th class="header">06</th><th class="header">07</th><th class="header">08</th><th class="header">09</th>
<th class="header">12</th><th class="header">13</th><th class="header">14</th><th class="header">15</th>
<th class="header">16</th><th class="header">20</th><th class="header">21</th><th class="header">22</th><th class="header">23</th>
</tr>
</thead>
<tbody>

<tr><td class="time-col">09â€“10</td>
<td class="green cell" id="d6-9"></td><td></td><td></td><td></td>
<td class="green cell" id="d12-9"></td><td class="green cell" id="d13-9"></td><td></td>
<td></td><td></td><td class="green cell" id="d20-9"></td><td></td><td></td><td></td>
</tr>

<tr><td class="time-col">10â€“11</td>
<td class="green cell" id="d6-10"></td><td></td><td class="green cell" id="d8-10"></td><td></td>
<td class="green cell" id="d12-10"></td><td class="green cell" id="d13-10"></td><td></td>
<td class="green cell" id="d15-10"></td><td></td><td class="green cell" id="d20-10"></td>
<td></td><td class="green cell" id="d22-10"></td><td class="green cell" id="d23-10"></td>
</tr>

<tr><td class="time-col">11â€“12</td>
<td class="green cell" id="d6-11"></td><td></td><td class="green cell" id="d8-11"></td><td></td>
<td class="green cell" id="d12-11"></td><td class="green cell" id="d13-11"></td><td></td>
<td class="green cell" id="d15-11"></td><td></td><td class="green cell" id="d20-11"></td>
<td></td><td class="green cell" id="d22-11"></td><td class="green cell" id="d23-11"></td>
</tr>

<tr><td class="time-col">12â€“13</td>
<td class="white">AlmoÃ§o</td><td class="white">AlmoÃ§o</td><td class="green cell" id="d8-12"></td><td class="white">AlmoÃ§o</td>
<td class="white">AlmoÃ§o</td><td class="white">AlmoÃ§o</td><td class="white">AlmoÃ§o</td>
<td class="green cell" id="d15-12"></td><td class="white">AlmoÃ§o</td><td class="white">AlmoÃ§o</td>
<td class="white">AlmoÃ§o</td><td class="green cell" id="d22-12"></td><td class="green cell" id="d23-12"></td>
</tr>

<tr><td class="time-col">13â€“14</td>
<td></td><td class="green cell" id="d7-13"></td><td></td><td class="green cell" id="d9-13"></td>
<td></td><td></td><td class="green cell" id="d14-13"></td><td></td>
<td class="green cell" id="d16-13"></td><td></td><td class="green cell" id="d21-13"></td><td></td><td></td>
</tr>

<tr><td class="time-col">14â€“15</td>
<td></td><td class="green cell" id="d7-14"></td><td></td><td class="green cell" id="d9-14"></td>
<td></td><td></td><td class="green cell" id="d14-14"></td><td></td>
<td class="green cell" id="d16-14"></td><td></td><td class="green cell" id="d21-14"></td><td></td><td></td>
</tr>

<tr><td class="time-col">15â€“16</td>
<td></td><td class="green cell" id="d7-15"></td><td></td><td class="green cell" id="d9-15"></td>
<td></td><td></td><td class="green cell" id="d14-15"></td><td></td>
<td class="green cell" id="d16-15"></td><td></td><td class="green cell" id="d21-15"></td><td></td><td></td>
</tr>

<tr><td class="time-col">16â€“17</td>
<td></td><td class="green cell" id="d7-16"></td><td></td><td class="green cell" id="d9-16"></td>
<td></td><td></td><td class="green cell" id="d14-16"></td><td></td>
<td class="green cell" id="d16-16"></td><td></td><td class="green cell" id="d21-16"></td><td></td><td></td>
</tr>

</tbody>
</table>

<footer>
Â© 2026 â€“ CCD 49/2025 |
<a href="mailto:aprendizagem.pt@gmail.com">aprendizagem.pt@gmail.com</a>
</footer>

<!-- ================= LOGIC ================= -->
<script>
function getLisbonTime(){
 return new Date(new Date().toLocaleString('en-US',{timeZone:'Europe/Lisbon'}));
}
function parseId(id){
 const m=id.match(/d(\d+)-(\d+)/);
 return m?{day:+m[1],hour:+m[2]}:null;
}
function tick(){
 const now=getLisbonTime();
 let aula=false;
 document.querySelectorAll('.cell').forEach(c=>{
  c.classList.remove('blinking');
  const i=parseId(c.id); if(!i)return;
  const start=new Date(2026,0,i.day,i.hour);
  const end=new Date(2026,0,i.day,i.hour+1);
  if(now>=start&&now<end){
   aula=true;
   c.classList.add('blinking');
   clockDisplay.textContent=
    `${String(i.day).padStart(2,'0')}/01/2026 - ${String(i.hour).padStart(2,'0')}:00 | Aula a decorrer`;
  }
 });
 if(!aula){
  clockDisplay.textContent=
   `${now.toLocaleDateString('pt-PT')} - ${now.toLocaleTimeString('pt-PT',{hour:'2-digit',minute:'2-digit'})}`;
 }
}
setInterval(tick,1000);
tick();

downloadPdf.onclick=()=>{
 const {jsPDF}=window.jspdf;
 html2canvas(scheduleTable).then(c=>{
  const pdf=new jsPDF('landscape','mm','a4');
  pdf.addImage(c.toDataURL('image/png'),'PNG',10,10,270,0);
  pdf.save('Horario_CCD49_Janeiro_2026.pdf');
 });
};
</script>

</body>
</html>